<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta charset="UTF-8">
  <title>TouchBox</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap">
  <link rel="stylesheet" href="styles.css">

  
<style>
/* Your CSS styles here */
body, html {
  height: 100%;
  margin: 0;
  font-family: 'Cairo', sans-serif; /* Use the Cairo font for the menu icon and options */
  font-size: 24px;
    user-zoom: fixed;
    user-select: none;

}

body {
  background-color: #424242; /* Set the background color to grey */
}  

/* Style for the top left text */
.top-left-text {
  position: absolute;
  bottom: 10px; /* Adjust the top position to your desired distance from the top edge */
  left: 10px; /* Adjust the left position to your desired distance from the left edge */
  color: white;
  font-size: 18px; /* Adjust the font size as needed */
}

/* Style for the menu icon */
.menu-icon {
  position: fixed;
  bottom: 10px;
  right: 10px;
  width: 80px;
  height: 80px;
  background-color: black;
  border-radius: 50%;
  color: white;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
   user-select: none;
}

/* Style for the menu options */
.menu {
  display: none;
  position: fixed;
  bottom: 100px;
  right: 10px;
  padding: 10px;
  background-color: black;
  border-radius: 5px;
    font-size: 24px;
  color: white; /* Set the font color for menu options to white */
   user-select: none;
}

.menu-button {
  display: block;
  margin-bottom: 10px;
  background-color: transparent;
  color: white;
  border: none;
  cursor: pointer;
    font-size: 24px;
   user-select: none;
}

.menu-button:focus {
  outline: none;
}

.menu-button:hover {
  background-color: #444;
}

/* Center the container both horizontally and vertically */
.container {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  justify-content: space-evenly;
  align-items: center;
  border: 1px solid white;
  padding: 7vw;
  border-radius: 2vw; /
}

.row {
  display: flex;
  flex-basis: 60px; /* Set a fixed height for each row (adjust this value as needed) */
  justify-content: space-evenly;
}

.circle {
  position: relative;
  width: 10vw;
  height: 10vw;
  border-radius: 50%;
  margin: 1vw;
  background-color: #3498db;
  border: none;
  cursor: pointer;
  box-shadow: 0 1vw .1vw rgba(0, 0, 0, 1);
  transition: background-color 0.1s ease, transform 0.1s ease;
  touch-action: manipulation; /* Ensure smooth touch interactions */
    transform-origin: center center;
}

/* Add animation when button is clicked */
.circle:active {
  transform: scale(0.95);
  box-shadow: 0 10px 1px rgba(0, 0, 0, 1); /* Slightly reduce the shadow when button is clicked */
}

/*Button Customization ←↓→↑ LPMPHPL1 LKMKHKL2*/
button[data-name="←"] {
  top: 0vw;
  left: 0vw;
}
button[data-name="↓"] {
  top: 0vw;
  left: .5vw;
}
button[data-name="→"] {
  top: 7vw;
  left: 0vw;
}
button[data-name="LP"] {
  top: 2vw;
  left: 0vw;
}
button[data-name="MP"] {
  top: -3vw;
  left: 0vw;
}
button[data-name="HP"] {
  top: -3vw;
  left: 0vw;
}
button[data-name="L1"] {
  top: -3vw;
  left: 0vw;
}
button[data-name="LK"] {
  top: 3vw;
  left: 17vw;
}
button[data-name="MK"] {
  top: -2vw;
  left: 17vw;
}
button[data-name="HK"] {
  top: -2vw;
  left: 17vw;
}
button[data-name="L2"] {
  top: -2vw;
  left: 17vw;
}

button[data-name="↑"] {
  position: relative;
  width: 12vw;
  height: 12vw;
  border: none;
  cursor: pointer;
  margin-left: 0px;
    top: 5vw;
  left: -5vw;
}
/* Your existing CSS styles here */

#touchcircle-container {
  position: fixed;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: white;
  transform: translate(-50%, -50%);
  pointer-events: none; /* Ignore mouse events on the touchcircle and trail */
  z-index: 9999; /* Ensure the touchcircle and trail appear on top of other elements */
  top: -100px; /* Adjust this value to position the touchcircle off-screen initially */
  left: -100px; /* Adjust this value to position the touchcircle off-screen initially */
}

#touchcircle {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  opacity: 0;
  pointer-events: none; /* Ensure the touchcircle doesn't capture mouse events */
  background-color: rgba(255, 255, 255, 0.5); /* Set the touchcircle color and opacity */
}

</style>

</head>
<body>
  <div id="touchcircle-container">
    <div id="touchcircle"></div>
    <div id="trail-container"></div>
  </div>
<!-- Menu icon -->
<div class="menu-icon" onclick="toggleMenu()">☰</div>

<!-- Menu options -->
<div class="menu" id="menu">
  <button class="menu-button" onclick="changeButtonColor()">Button Color</button>
  <button class="menu-button" onclick="changeBackgroundColor()">Background Color</button>
</div>
  <!-- Top left text -->
  <div class="top-left-text">TouchBox v0.1<br>by @XPISigmaArt on Twitter<br>ConstructCoreWorks.com</div>

  <div class="container">
    <div class="row">
      <button class="circle" data-name="←"></button>
      <button class="circle" data-name="↓"></button>
      <button class="circle" data-name="→"></button>
      <button class="circle" data-name="LP"></button>
      <button class="circle" data-name="MP"></button>
      <button class="circle" data-name="HP"></button>
      <button class="circle" data-name="L1"></button>
    </div>
    <div class="row">


      <button class="circle" data-name="LK"></button>
      <button class="circle" data-name="MK"></button>
      <button class="circle" data-name="HK"></button>
      <button class="circle" data-name="L2"></button>
    </div>
    <div class="row">
     <button class="circle" data-name="↑"></button>
    </div>
  </div>

<script>
    // Function to trigger vibration (if supported by the device)
function vibrateDevice() {
  if ('vibrate' in navigator) {
    // Vibrate for 50 milliseconds
    navigator.vibrate(50);
  }
}

// Function to set the button color from cache
function setButtonColorFromCache() {
  const storedColor = localStorage.getItem('buttonColor');
  if (storedColor) {
    document.querySelectorAll('.circle').forEach(circle => {
      circle.style.backgroundColor = storedColor;
    });
  }
}

// Function to set the background color from cache
function setBackgroundColorFromCache() {
  const storedColor = localStorage.getItem('backgroundColor');
  if (storedColor) {
    document.body.style.backgroundColor = storedColor;
  }
}

// Function to toggle the menu visibility
function toggleMenu() {
  const menu = document.getElementById('menu');
  menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
}

// Function to change the color of the buttons
function changeButtonColor() {
  const colorPicker = document.createElement('input');
  colorPicker.type = 'color';
  colorPicker.addEventListener('input', () => {
    const buttons = document.querySelectorAll('.circle');
    const newColor = colorPicker.value;
    buttons.forEach(button => {
      button.style.backgroundColor = newColor;
      saveButtonColorToCache(newColor); // Save the chosen color to cache
    });
  });
  colorPicker.click();
}

// Function to change the background color of the app
function changeBackgroundColor() {
  const colorPicker = document.createElement('input');
  colorPicker.type = 'color';
  colorPicker.addEventListener('input', () => {
    const appBackground = document.body;
    const newColor = colorPicker.value;
    appBackground.style.backgroundColor = newColor;
    saveBackgroundColorToCache(newColor); // Save the chosen color to cache
  });
  colorPicker.click();
}

// On page load, set the button color and background color from cache
document.addEventListener('DOMContentLoaded', () => {
  setButtonColorFromCache();
  setBackgroundColorFromCache();
});

//mouse stuff
// Function to handle touch or mouse move event
function handleTouchOrMouseMove(event) {
  const touchcircleContainer = document.getElementById('touchcircle-container');
  const touchcircle = document.getElementById('touchcircle');

  // Check if the left mouse button is held down (for touch, use the first touch point)
  const isLeftButtonDown = event.buttons === 1 || (event.touches && event.touches.length > 0);

  if (isLeftButtonDown) {
    // Show the touchcircle
    touchcircleContainer.style.display = 'block';

    // Move the touchcircle with the touch/mouse position
    const touchX = event.clientX || (event.touches && event.touches[0].clientX);
    const touchY = event.clientY || (event.touches && event.touches[0].clientY);
    touchcircleContainer.style.left = touchX + 'px';
    touchcircleContainer.style.top = touchY + 'px';

    // Check if the touch circle is touching a circle button
    const touchingCircle = isTouchingCircleButton(touchX, touchY);

    // Handle button press/unpress
    if (touchingCircle) {
      if (!pressedButton) {
        pressedButton = touchingCircle;
        vibrateDevice(); // Vibrate when button is pressed
        touchingCircle.style.top = '1vw'; // Move the button down by 1vw
        console.log('Button Name:', touchingCircle.dataset.name);
      }
    } else {
      if (pressedButton) {
        pressedButton.style.top = '0'; // Move the button back up to its original position
        pressedButton = null;
      }
    }
  } else {
    // Hide the touchcircle when the left button is not held down
    touchcircleContainer.style.display = 'none';

    // Unpress the button when the touch circle is not touching any circle button
    if (pressedButton) {
      pressedButton.style.top = '0'; // Move the button back up to its original position
      pressedButton = null;
    }
  }
}

// Attach the touch or mouse move event to the document
document.addEventListener('mousemove', handleTouchOrMouseMove);
document.addEventListener('touchmove', handleTouchOrMouseMove);

// Function to handle mouse down event (left button pressed)
function handleMouseDown(event) {
  const touchcircleContainer = document.getElementById('touchcircle-container');

  // Show the touchcircle
  touchcircleContainer.style.display = 'block';

  // Move the touchcircle with the mouse position
  const touchX = event.clientX;
  const touchY = event.clientY;
  touchcircleContainer.style.left = touchX + 'px';
  touchcircleContainer.style.top = touchY + 'px';
}

// Attach the mouse down event to the document
document.addEventListener('mousedown', handleMouseDown);

// Function to handle global mouse up event (left button released)
function handleGlobalMouseUp() {
  const touchcircleContainer = document.getElementById('touchcircle-container');
  touchcircleContainer.style.display = 'none'; // Hide the touchcircle when the left button is released

  // Unpress the button when the touch circle is not touching any circle button
  if (pressedButton) {
    pressedButton.style.top = '0'; // Move the button back up to its original position
    pressedButton = null;
  }
}

// Attach the global mouse up event to the document
document.addEventListener('mouseup', handleGlobalMouseUp);

// Function to handle global touch end event (touch released)
function handleGlobalTouchEnd() {
  const touchcircleContainer = document.getElementById('touchcircle-container');
  touchcircleContainer.style.display = 'none'; // Hide the touchcircle when the touch is released

  // Unpress the button when the touch circle is not touching any circle button
  if (pressedButton) {
    pressedButton.style.top = '0'; // Move the button back up to its original position
    pressedButton = null;
  }
}

// Attach the global touch end event to the document
document.addEventListener('touchend', handleGlobalTouchEnd);

//istouchingcircle
// Function to check if the touch circle is touching a circle button
function isTouchingCircleButton(touchX, touchY) {
  const circles = document.querySelectorAll('.circle');
  for (const circle of circles) {
    const rect = circle.getBoundingClientRect();
    const circleX = rect.left + rect.width / 2;
    const circleY = rect.top + rect.height / 2;
    const distance = Math.sqrt((touchX - circleX) ** 2 + (touchY - circleY) ** 2);
    if (distance <= rect.width / 2) {
      return circle;
    }
  }
  return null;
}

</script>
  <script>
  </script>
  <!-- Audio element to play the "button.wav" sound -->
  <audio id="myAudio" controls style="display: none;">
    <source src="button.wav" type="audio/wav">
    Your browser does not support the audio element.
  </audio>
</body>
</html>
