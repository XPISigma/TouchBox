<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">

  <meta charset="UTF-8">
  <title>TouchBox</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap">
  <link rel="stylesheet" href="styles.css">

  
<style>
/* Your CSS styles here */
body, html {
  height: 100%;
  margin: 0;
  font-family: 'Cairo', sans-serif; /* Use the Cairo font for the menu icon and options */
  font-size: 24px;
    user-zoom: fixed;
    user-select: none;

}

body {
  background-color: #424242; /* Set the background color to grey */
}  

/* Style for the top left text */
.top-left-text {
  position: absolute;
  bottom: 10px; /* Adjust the top position to your desired distance from the top edge */
  left: 10px; /* Adjust the left position to your desired distance from the left edge */
  color: white;
  font-size: 1.5vw; /* Adjust the font size as needed */
    text-shadow: .1vw .1vw .1vw #000; /* Add an outline effect with a shadow */
}

/* Style for the menu icon */
.menu-icon {
  position: fixed;
  bottom: 10px;
  right: 10px;
  width: 80px;
  height: 80px;
  background-color: black;
  border-radius: 50%;
  color: white;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
   user-select: none;
}

/* Style for the menu options */
.menu {
  display: none;
  position: fixed;
  bottom: 100px;
  right: 10px;
  padding: 10px;
  background-color: black;
  border-radius: 5px;
    font-size: 24px;
  color: white; /* Set the font color for menu options to white */
   user-select: none;
    z-index:5;
  
}

.menu-button {
  display: block;
  margin-bottom: 10px;
  background-color: transparent;
  color: white;
  border: none;
  cursor: pointer;
    font-size: 24px;
   user-select: none;
  z-index:5;
}

.menu-button:focus {
  outline: none;
}

.menu-button:hover {
  background-color: #444;
}

/* Center the container both horizontally and vertically */
.container {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  justify-content: space-evenly;
  align-items: center;
  border: 1px solid white;
  padding: 7vw;
  border-radius: 2vw; 
  z-index: 0;
}

.row {
  display: flex;
  flex-basis: 60px; /* Set a fixed height for each row (adjust this value as needed) */
  justify-content: space-evenly;
}

.switch {
  position: relative;
  width: 10vw;
  height: 10vw;
  border-radius: 50%;
  margin: 1vw;
  background-color: #3498db;
  border: none;
  cursor: pointer;
  box-shadow: 0 1vw .1vw rgba(0, 0, 0, 1);
  transition: background-color 0.1s ease, transform 0.1s ease;
  transform-origin: center center;
}

/* Add animation when button is clicked */
.switch:active {
  transform: scale(0.95);
  box-shadow: 0 .3vw .1vw rgba(0, 0, 0, 1); /* Slightly reduce the shadow when button is clicked */
    position: relative;
}

/*Button Customization ←↓→↑ LPMPHPL1 LKMKHKL2*/


button[data-name="↓"] {
  top: 0vw;
  left: .5vw;
}
button[data-name="→"] {
  top: 7vw;
  left: 0vw;
}
button[data-name="LP"] {
  top: 2vw;
  left: 0vw;
}
button[data-name="MP"] {
  top: -3vw;
  left: 0vw;
}
button[data-name="HP"] {
  top: -3vw;
  left: 0vw;
}
button[data-name="L1"] {
  top: -3vw;
  left: 0vw;
}
button[data-name="LK"] {
  top: 3vw;
  left: 17vw;
}
button[data-name="MK"] {
  top: -2vw;
  left: 17vw;
}
button[data-name="HK"] {
  top: -2vw;
  left: 17vw;
}
button[data-name="L2"] {
  top: -2vw;
  left: 17vw;
}

button[data-name="↑"] {
  position: relative;
  width: 12vw;
  height: 12vw;
  border: none;
  cursor: pointer;
  margin-left: 0px;
    top: 5vw;
  left: -5vw;
}
/* Your existing CSS styles here */

#touchcircle-container {
  position: fixed;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: white;
  transform: translate(-50%, -50%);
  pointer-events: none; /* Ignore mouse events on the touchcircle and trail */
  z-index: 9999; /* Ensure the touchcircle and trail appear on top of other elements */
  top: -100px; /* Adjust this value to position the touchcircle off-screen initially */
  left: -100px; /* Adjust this value to position the touchcircle off-screen initially */
}

#touchcircle {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  opacity: 0;
  pointer-events: none; /* Ensure the touchcircle doesn't capture mouse events */
  background-color: rgba(255, 255, 255, 0.5); /* Set the touchcircle color and opacity */
}

#latest-presses {
  list-style-type: none;
  padding: 0;
  margin: 0;
  display: flex;
  justify-content: center; /* Center the items horizontally */
  align-items: center; /* Center the items vertically */
  position: top; /* Use fixed position to center the container */
  top: 0vw; /* Position from the top edge */
  left: 0; /* Position from the left edge */
  width: 100%; /* Take up the full width of the screen */
  transform: translateY(-50%); /* Adjust to vertically center the container */
background-color: rgba(0, 0, 0, 0.7);
    z-index:5;
}
#latest-presses li {
  margin-right: 2vw;
  color: white;
  font-size: 2vw; /* Set the initial font size for other items */
    list-style-type: none;
  padding: 1vw;
  margin: 0vw;
  display: flex;
  justify-content: center; /* Center the items horizontally */
  align-items: center; /* Center the items vertically */
  text-shadow: .2vw .2vw .1vw #000; /* Add an outline effect with a shadow */
    z-index:5;

}

</style>

</head>
<body>
    <div id="text-feed">
    <h2></h2>
    <ul id="latest-presses"></ul>
  </div>
  <div id="touchcircle-container">
    <div id="touchcircle"></div>
  </div>
<!-- Menu icon -->
<div class="menu-icon" onclick="toggleMenu()">☰</div>

<!-- Menu options -->
<div class="menu" id="menu">
  <button class="menu-button" onclick="changeButtonColor()">Button Color</button>
  <button class="menu-button" onclick="changeBackgroundColor()">Background Color</button>
</div>
  <!-- Top left text -->
  <div class="top-left-text">TouchBox v0.2<br>by @XPISigmaArt on Twitter<br>ConstructCoreWorks.com</div>

  <div class="container">
    <div class="row">
      <button class="switch" data-name="←"></button>
      <button class="switch" data-name="↓"></button>
      <button class="switch" data-name="→"></button>
      <button class="switch" data-name="LP"></button>
      <button class="switch" data-name="MP"></button>
      <button class="switch" data-name="HP"></button>
      <button class="switch" data-name="L1"></button>
    </div>
    <div class="row">
      <button class="switch" data-name="LK"></button>
      <button class="switch" data-name="MK"></button>
      <button class="switch" data-name="HK"></button>
      <button class="switch" data-name="L2"></button>
    </div>
    <div class="row">
     <button class="switch" data-name="↑"></button>
    </div>
  </div>

<script>
// Function to trigger vibration (if supported by the device)
function vibrateDevice() {
  if ('vibrate' in navigator) {
    // Vibrate for 50 milliseconds
    navigator.vibrate(50);
  }
}

// Function to set the button color from cache
function setButtonColorFromCache() {
  const storedColor = localStorage.getItem('buttonColor');
  if (storedColor) {
    document.querySelectorAll('.switch').forEach(circle => {
      circle.style.backgroundColor = storedColor;
    });
  }
}

// Function to set the background color from cache
function setBackgroundColorFromCache() {
  const storedColor = localStorage.getItem('backgroundColor');
  if (storedColor) {
    document.body.style.backgroundColor = storedColor;
  }
}

// Function to save the button color to cache
function saveButtonColorToCache(color) {
  localStorage.setItem('buttonColor', color);
}

// Function to save the background color to cache
function saveBackgroundColorToCache(color) {
  localStorage.setItem('backgroundColor', color);
}

// Function to toggle the menu visibility
function toggleMenu() {
  const menu = document.getElementById('menu');
  menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
}

// Function to change the color of the buttons
function changeButtonColor() {
  const colorPicker = document.createElement('input');
  colorPicker.type = 'color';
  colorPicker.addEventListener('input', () => {
    const buttons = document.querySelectorAll('.switch');
    const newColor = colorPicker.value;
    buttons.forEach(button => {
      button.style.backgroundColor = newColor;
    });
    saveButtonColorToCache(newColor); // Save the chosen color to cache
  });
  colorPicker.click();
}

// Function to change the background color of the app
function changeBackgroundColor() {
  const colorPicker = document.createElement('input');
  colorPicker.type = 'color';
  colorPicker.addEventListener('input', () => {
    const appBackground = document.body;
    const newColor = colorPicker.value;
    appBackground.style.backgroundColor = newColor;
    saveBackgroundColorToCache(newColor); // Save the chosen color to cache
  });
  colorPicker.click();
}

// On page load, set the button color and background color from cache
document.addEventListener('DOMContentLoaded', () => {
  setButtonColorFromCache();
  setBackgroundColorFromCache();
});

// Function to check if the touchcursor is inside a circle button
function isTouchingCircleButton(x, y) {
  const buttons = document.querySelectorAll('.switch');
  for (const button of buttons) {
    const rect = button.getBoundingClientRect();
    if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
      return button;
    }
  }
  return null;
}

//mouse stuff
let touchcursorVisible = false;

// Function to handle touch or mouse move event
function handleTouchOrMouseMove(event) {
  const touchcircleContainer = document.getElementById('touchcircle-container');
  const touchcircle = document.getElementById('touchcircle');

  // Check if the left mouse button is held down (for touch, use the first touch point)
  const isLeftButtonDown = event.buttons === 1 || (event.touches && event.touches.length > 0);

  // Move the touchcircle with the touch/mouse position
  const touchX = event.clientX || (event.touches && event.touches[0].clientX);
  const touchY = event.clientY || (event.touches && event.touches[0].clientY);
  touchcircleContainer.style.left = touchX + 'px';
  touchcircleContainer.style.top = touchY + 'px';

  // Check if the touch circle is touching a circle button
  const touchingCircle = isTouchingCircleButton(touchX, touchY);

  // Handle button press/unpress
  document.querySelectorAll('.switch').forEach(button => {
    const isTouchingButton = touchingCircle === button;
    if (isTouchingButton) {
      if (!button.classList.contains('active')) {
        button.classList.add('active');
        vibrateDevice(); // Vibrate when button is pressed
        console.log('Button Name:', button.dataset.name);
      }
    } else {
      button.classList.remove('active');
    }
  });

  // Show/hide the touchcircle based on the touchcursor status
  if (isLeftButtonDown) {
    touchcircleVisible = true;
    touchcircleContainer.style.display = 'block';
  } else {
    touchcircleVisible = false;
    touchcircleContainer.style.display = 'none';
  }
}

//feed
// Array to keep track of the last 20 button presses
const buttonPresses = [];

// Function to update the text feed with the latest button press
function updateTextFeed(buttonName) {
  buttonPresses.push(buttonName); // Add the latest press to the array

  // Limit the array to 20 items
  if (buttonPresses.length > 20) {
    buttonPresses.shift(); // Remove the oldest item
  }

  const textFeedList = document.getElementById('latest-presses');
  textFeedList.innerHTML = ''; // Clear the current text feed

  // Add the button presses to the text feed horizontally
  buttonPresses.forEach(name => {
    const listItem = document.createElement('li');
    listItem.textContent = name;
    textFeedList.appendChild(listItem);
  });
}

// Function to handle button press/unpress
document.querySelectorAll('.switch').forEach(button => {
  button.addEventListener('click', () => {
    const buttonName = button.dataset.name;
    updateTextFeed(buttonName); // Update the text feed with the latest press
    vibrateDevice(); // Vibrate when button is pressed
    console.log('Button Name:', buttonName);
  });
});


</script>
  <!-- Audio element to play the "button.wav" sound -->
  <audio id="myAudio" controls style="display: none;">
    <source src="button.wav" type="audio/wav">
    Your browser does not support the audio element.
  </audio>
</body>
</html>
